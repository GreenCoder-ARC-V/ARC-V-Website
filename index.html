<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ARC-V Secure Terminal</title>

<style>
:root { --accent:#00ffcc; }

* { box-sizing:border-box; }

body {
    margin:0;
    height:100vh;
    background:black;
    color:var(--accent);
    font-family:monospace;
    display:flex;
    justify-content:center;
    align-items:center;
}

.view {
    display:none;
    text-align:center;
    width:90%;
    max-width:700px;
    animation:fade .6s ease;
}
.view.active { display:block; }

#screen {
    white-space:pre-wrap;
    min-height:220px;
    margin-bottom:20px;
}

input, button {
    background:black;
    color:var(--accent);
    border:1px solid var(--accent);
    padding:10px;
    margin:6px 0;
    width:100%;
    font-family:monospace;
}

button:hover {
    background:var(--accent);
    color:black;
    cursor:pointer;
}

@keyframes fade {
    from { opacity:0; transform:translateY(10px); }
    to { opacity:1; transform:translateY(0); }
}
</style>
</head>

<body>

<!-- SOUND EFFECTS -->
<audio id="click" src="click.mp3"></audio>
<audio id="success" src="success.mp3"></audio>
<audio id="fail" src="fail.mp3"></audio>

<!-- LOGIN -->
<div class="view active" id="login">
    <h2>ARC-V SECURE TERMINAL</h2>
    <input id="email" placeholder="Email">
    <input id="password" type="password" placeholder="Access Code">
    <button onclick="login()">ACCESS</button>
</div>

<!-- TERMINAL -->
<div class="view" id="terminal">
    <div id="screen"></div>
    <div id="menu"></div>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

/* ðŸ”‘ PASTE YOUR FIREBASE CONFIG HERE */
const firebaseConfig = {
  apiKey: "AIzaSyBVMI-1qNaTxw2T-TiPGVW6-FCTJyMCytg",
  authDomain: "arcvwebbackend.firebaseapp.com",
  projectId: "arcvwebbackend"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* UI HELPERS */
const screen = document.getElementById("screen");
const menu = document.getElementById("menu");

function play(id){ document.getElementById(id).play(); }
function show(id){
    document.querySelectorAll(".view").forEach(v=>v.classList.remove("active"));
    document.getElementById(id).classList.add("active");
}
function clearUI(){ screen.textContent=""; menu.innerHTML=""; }
const sleep = ms => new Promise(r=>setTimeout(r,ms));

async function type(text, speed=25){
    for (let c of text){ screen.textContent+=c; await sleep(speed); }
    screen.textContent+="\n";
}

/* LOGIN */
async function login(){
    play("click");
    const email = document.getElementById("email").value;
    const pass = document.getElementById("password").value;

    try {
        const cred = await signInWithEmailAndPassword(auth,email,pass);
        play("success");

        const userDoc = await getDoc(doc(db,"users",cred.user.uid));
        const rank = userDoc.data().rank;

        show("terminal");
        clearUI();

        await type("ACCESS GRANTED",60);
        await sleep(500);
        mainMenu(rank);

    } catch {
        play("fail");
        alert("ACCESS DENIED");
    }
}

/* MAIN MENU */
async function mainMenu(rank){
    clearUI();
    await type(`MAIN CONTROL\nRANK: ${rank}\n`);

    menu.innerHTML = `
      <button onclick="missions()">MISSIONS</button>
      ${rank!=="Guest" ? `<button onclick="projects()">PROJECTS</button>` : ""}
      ${rank==="Admin" ? `<button onclick="admin()">ADMIN</button>` : ""}
      <button onclick="news()">NEWS</button>
    `;
}

/* SECTIONS */
async function missions(){
    play("click");
    clearUI();
    await type("MISSIONS\nâ€¢ Invisible Watch\nMore coming soon");
    menu.innerHTML=`<button onclick="mainMenu(currentRank)">RETURN</button>`;
}

async function projects(){
    play("click");
    clearUI();
    await type("PROJECTS\n");
    menu.innerHTML=`
      <button onclick="arc9()">ARC-9 PHANTOM TEMPEST</button>
      <button onclick="fd()">FLYING DOME</button>
      <button onclick="mainMenu(currentRank)">RETURN</button>`;
}

async function arc9(){
    clearUI();
    await type("ARC-9 PHANTOM TEMPEST\n",20);
    await type("Elite ARC-V stealth aircraft for high-risk missions.",15);
    menu.innerHTML=`<button onclick="projects()">RETURN</button>`;
}

async function fd(){
    clearUI();
    await type("FLYING DOME\n",20);
    await type("Nationwide coordinated drone monitoring network.",15);
    menu.innerHTML=`<button onclick="projects()">RETURN</button>`;
}

async function news(){
    play("click");
    clearUI();
    await type("NEWS\nNew tech and hierarchy updates coming soon.");
    menu.innerHTML=`<button onclick="mainMenu(currentRank)">RETURN</button>`;
}

async function admin(){
    clearUI();
    await type("ADMIN PANEL\nUser management & system logs.");
    menu.innerHTML=`<button onclick="mainMenu(currentRank)">RETURN</button>`;
}

/* GLOBAL */
let currentRank="Guest";
auth.onAuthStateChanged(async user=>{
    if(user){
        const docSnap = await getDoc(doc(db,"users",user.uid));
        currentRank = docSnap.data().rank;
    }
});
</script>

</body>
</html>
